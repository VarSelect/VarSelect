Wed May 24 17:29:46 2017	VS annot start
Wed May 24 17:29:46 2017	Jobid: 20170524172945
Wed May 24 17:29:46 2017	-n 4 -p example1.ped -d ./example1_20170524172945_varselect.db -v example1.txt -j 20170524172945
Wed May 24 17:29:46 2017	Load and check VCF file list start
Wed May 24 17:29:46 2017	Clean variants with multiple line or wrong sample format values: NA12878_chr22.vcf.gz
Wed May 24 17:30:16 2017	Clean variants with multiple line or wrong sample format values: NA12891_chr22.vcf.gz
Wed May 24 17:30:52 2017	Clean variants with multiple line or wrong sample format values: NA12892_chr22.vcf.gz
Wed May 24 17:31:34 2017	Load and check VCF file list finish
Wed May 24 17:31:34 2017	Load ped file start
Wed May 24 17:31:34 2017	Output sex infomation of Sample to ./VarSelectAnalysisResult_20170524172945/example1_20170524172945_varselect_sample_sex.txt
Wed May 24 17:31:34 2017	Load ped file finish
Wed May 24 17:31:34 2017	Check and concat vcf files from same sample start.
Wed May 24 17:31:38 2017	Check and concat vcf files from same sample finish.
Wed May 24 17:31:38 2017	Merge vcf files from different samples start.
Wed May 24 17:37:57 2017	Merge vcf files from different samples finish.
Wed May 24 17:37:57 2017	Fixing ploidy of sex chromosome start
Wed May 24 17:38:16 2017	Fixing ploidy of sex chromosome finish

/peterhouse/lchen/csardas/varselect_dev/scripts/vsann2.pl -v ./VarSelectAnalysisResult_20170524172945/example1_20170524172945_varselect_cleanXY.vcf.gz -p example1.ped -j 20170524172945 -d ./example1_20170524172945_varselect.db -n 4 2>./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr_vsann2_20170524172945.log
Wed May 24 17:38:16 2017	Running VEP start
Wed May 24 17:38:16 2017	Running snpEff start
Wed May 24 17:38:17 2017	Running ANNOVAR start
Wed May 24 18:06:14 2017	Running VEP finish
Wed May 24 18:06:14 2017	Gemini load vcf to db start
Wed May 24 19:07:20 2017	Running ANNOVAR finish
Indexing /peterhouse/lchen/csardas/varselect_publish/examples/example1/VarSelectAnalysisResult_20170524172945/work_20170524172945/snpeff_tmp.vcf.gz with grabix.
Loading 93141 variants.
Breaking /peterhouse/lchen/csardas/varselect_publish/examples/example1/VarSelectAnalysisResult_20170524172945/work_20170524172945/snpeff_tmp.vcf.gz into 4 chunks.
Loading chunk 0.
Loading chunk 1.
Loading chunk 2.
Loading chunk 3.
Done loading 93141 variants in 4 chunks.
2017-05-24 19:20:06 merging 4 chunks.
2017-05-24 19:20:18 merging 2 chunks.
2017-05-24 19:20:34 merged to final database....
2017-05-24 19:20:34 moved.
storing version, header, etc.
storing gene-detailed
storing gene-summary
updating gene-table
building indices
Wed May 24 19:28:07 2017	Running snpEff finish
Indexing /peterhouse/lchen/csardas/varselect_publish/examples/example1/VarSelectAnalysisResult_20170524172945/VsResult_20170524172945_vep.vcf.gz with grabix.
Loading 93141 variants.
Breaking /peterhouse/lchen/csardas/varselect_publish/examples/example1/VarSelectAnalysisResult_20170524172945/VsResult_20170524172945_vep.vcf.gz into 4 chunks.
Loading chunk 0.
Loading chunk 1.
Loading chunk 2.
Loading chunk 3.
Done loading 93141 variants in 4 chunks.
2017-05-24 19:30:38 merging 4 chunks.
2017-05-24 19:30:54 merging 2 chunks.
2017-05-24 19:31:22 merged to final database....
2017-05-24 19:31:22 moved.
storing version, header, etc.
storing gene-detailed
storing gene-summary
updating gene-table
building indices
Wed May 24 19:38:40 2017	Gemini load vcf to db finish
Wed May 24 19:38:40 2017	Gemini pathways start
Wed May 24 19:45:28 2017	13006 variants with pathways annotation
Wed May 24 19:45:45 2017	Gemini pathways finish
update variants SET 'AF'=? , 'BaseQRankSum'=? , 'FS'=? , 'MQRankSum'=? , 'ReadPosRankSum'=? , 'SOR'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 93141
Wed May 24 19:47:27 2017	update 10000 variants	10000 : 0
Wed May 24 19:47:33 2017	update 20000 variants	10000 : 0
Wed May 24 19:47:41 2017	update 30000 variants	10000 : 0
Wed May 24 19:47:48 2017	update 40000 variants	10000 : 0
Wed May 24 19:47:57 2017	update 50000 variants	10000 : 0
Wed May 24 19:48:08 2017	update 60000 variants	10000 : 0
Wed May 24 19:48:20 2017	update 70000 variants	10000 : 0
Wed May 24 19:48:28 2017	update 80000 variants	10000 : 0
Wed May 24 19:48:38 2017	update 90000 variants	10000 : 0
match 93141 records
Wed May 24 19:48:55 2017	sqlite3 ./example1_20170524172945_varselect.db 'alter table variants rename to vep_variants' 2> ./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr.tbl_rename_vep_variants_20170524172945.log 
Wed May 24 19:48:55 2017	CREATE & INSERT TABLE varselect_info start
Wed May 24 19:48:55 2017	CREATE TABLE IF NOT EXISTS varselect_info (  sn INTEGER  , vcfgz_for_analysis BLOB  , sample_list TEXT  , caller_list TEXT  , multicaller BOOLEAN )
Wed May 24 19:48:57 2017	CREATE & INSERT TABLE varselect_info finish
Wed May 24 19:49:20 2017	Create table annovar_variants start
Wed May 24 19:49:25 2017	Create table annovar_variants finish
Wed May 24 19:49:25 2017	Extract info fields from ANNOVAR finish
update annovar_variants SET '1000G_AFR'=? , '1000G_ALL'=? , '1000G_AMR'=? , '1000G_EAS'=? , '1000G_EUR'=? , '1000G_SAS'=? , '1000g2015aug_all'=? , 'AA_alt'=? , 'AA_position'=? , 'AA_ref'=? , 'APOGEE'=? , 'APOGEE_probN'=? , 'APOGEE_probP'=? , 'Associated_disease'=? , 'CADD'=? , 'CADD_phred'=? , 'CADD_score'=? , 'CAROL'=? , 'CAROL_score'=? , 'CG46'=? , 'CHASM_FDR'=? , 'CHASM_pvalue'=? , 'CLINSIG'=? , 'CLNACC'=? , 'CLNDBN'=? , 'CLNDSDB'=? , 'CLNDSDBID'=? , 'COSMIC_frequency'=? , 'COSMIC_id'=? , 'COSMIC_samples'=? , 'COSMIC_tumor_site'=? , 'COVEC_WMV'=? , 'COVEC_WMV_score'=? , 'Codon_substitution'=? , 'Condel'=? , 'Condel_score'=? , 'EFIN_HD'=? , 'EFIN_HD_score'=? , 'EFIN_SP'=? , 'EFIN_SP_score'=? , 'ESP6500siv2_AA'=? , 'ESP6500siv2_ALL'=? , 'ESP6500siv2_EA'=? , 'Ensembl_gene_id'=? , 'Ensembl_protein_id'=? , 'Ensembl_transcript_id'=? , 'ExAC_AFR'=? , 'ExAC_ALL'=? , 'ExAC_AMR'=? , 'ExAC_EAS'=? , 'ExAC_FIN'=? , 'ExAC_NFE'=? , 'ExAC_OTH'=? , 'ExAC_SAS'=? , 'ExAC_nonpsych_AFR'=? , 'ExAC_nonpsych_ALL'=? , 'ExAC_nonpsych_AMR'=? , 'ExAC_nonpsych_EAS'=? , 'ExAC_nonpsych_FIN'=? , 'ExAC_nonpsych_NFE'=? , 'ExAC_nonpsych_OTH'=? , 'ExAC_nonpsych_SAS'=? , 'ExAC_nontcga_AFR'=? , 'ExAC_nontcga_ALL'=? , 'ExAC_nontcga_AMR'=? , 'ExAC_nontcga_EAS'=? , 'ExAC_nontcga_FIN'=? , 'ExAC_nontcga_NFE'=? , 'ExAC_nontcga_OTH'=? , 'ExAC_nontcga_SAS'=? , 'FATHMM_coding'=? , 'FATHMM_noncoding'=? , 'FatHmmW'=? , 'FatHmmW_score'=? , 'FatHmm_pred'=? , 'FatHmm_score'=? , 'GME_AF'=? , 'GME_AP'=? , 'GME_CA'=? , 'GME_Israel'=? , 'GME_NEA'=? , 'GME_NWA'=? , 'GME_SD'=? , 'GME_TP'=? , 'Gene_position'=? , 'Gene_symbol'=? , 'HRC_AC'=? , 'HRC_AF'=? , 'HRC_AN'=? , 'HRC_non1000G_AC'=? , 'HRC_non1000G_AF'=? , 'HRC_non1000G_AN'=? , 'ICGC_Id'=? , 'ICGC_Occurrence'=? , 'Kaviar_AC'=? , 'Kaviar_AF'=? , 'Kaviar_AN'=? , 'MISTIC_coevo_sites'=? , 'MISTIC_mean_MI_score'=? , 'Meta_SNP'=? , 'Meta_SNP_RI'=? , 'Meta_SNP_score'=? , 'MitImpact_id'=? , 'MutationAssessor'=? , 'MutationAssessor_score'=? , 'MutationAssessor_transf'=? , 'MutationAssessor_transf_score'=? , 'Ncbi_gene_id'=? , 'Ncbi_protein_id'=? , 'OXPHOS_complex'=? , 'PANTHER'=? , 'PANTHER_score'=? , 'PROVEAN'=? , 'PROVEAN_score'=? , 'PhD_SNP'=? , 'PhD_SNP_score'=? , 'PhastCons_100V'=? , 'PhyloP_100V'=? , 'PolyPhen2'=? , 'PolyPhen2_score'=? , 'PolyPhen2_transf'=? , 'PolyPhen2_transf_score'=? , 'PopFreqMax'=? , 'SIFT'=? , 'SIFT_score'=? , 'SIFT_transf'=? , 'SIFT_transf_score'=? , 'SNAP'=? , 'SNAP_score'=? , 'SiteVar'=? , 'Uniprot_id'=? , 'Uniprot_name'=? , 'VEST_FDR'=? , 'VEST_pvalue'=? , 'Variant_class'=? , 'Variant_status'=? , 'avsift'=? , 'avsnp147'=? , 'cg69'=? , 'cosmic70'=? , 'dbSNP_id'=? , 'dbscSNV_ADA_SCORE'=? , 'dbscSNV_RF_SCORE'=? , 'gerpxxgt2'=? , 'gwasCatalog'=? , 'nci60'=? , 'phastConsElements46way'=? , 'tfbsConsSites'=? , 'wgRna'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 93141
Wed May 24 19:54:17 2017	update 10000 variants	9876 : 124
Wed May 24 19:54:32 2017	update 20000 variants	9886 : 114
Wed May 24 19:54:46 2017	update 30000 variants	9906 : 94
Wed May 24 19:55:00 2017	update 40000 variants	9877 : 123
Wed May 24 19:55:15 2017	update 50000 variants	9862 : 138
Wed May 24 19:55:28 2017	update 60000 variants	9883 : 117
Wed May 24 19:55:37 2017	update 70000 variants	9866 : 134
Wed May 24 19:55:49 2017	update 80000 variants	9902 : 98
Wed May 24 19:56:00 2017	update 90000 variants	9930 : 70
match 93141 records
Wed May 24 19:56:32 2017	Extract info fields from ANNOVAR finish
Wed May 24 19:56:32 2017	Create table varselect_variants start
Wed May 24 19:56:32 2017	sqlite3 ./example1_20170524172945_varselect.db 'CREATE TABLE varselect_variants as select variant_id,chrom,start,"end",ref,alt from vep_variants '
Wed May 24 19:56:35 2017	sqlite3 ./example1_20170524172945_varselect.db 'CREATE INDEX vslvars_vid_idx ON varselect_variants(variant_id)'  2> ./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr_idx_create_vslvars_varselect_variants_20170524172945.log 
Wed May 24 19:56:37 2017	Create table varselect_variants finish
Wed May 24 19:56:37 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/vsl_annot.pl  -j 20170524172945  -f ./VarSelectAnalysisResult_20170524172945/VsResult_20170524172945_pathway.vcf.gz  -a extract  -e pathway  -t text  -c pathway  -d ./example1_20170524172945_varselect.db  -b varselect_variants  2> ./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr_vsl_pathway_20170524172945.log 
update varselect_variants SET 'pathway'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 93141
Wed May 24 19:57:28 2017	update 10000 variants	705 : 9295
Wed May 24 19:57:28 2017	update 20000 variants	2047 : 7953
Wed May 24 19:57:29 2017	update 30000 variants	1741 : 8259
Wed May 24 19:57:29 2017	update 40000 variants	450 : 9550
Wed May 24 19:57:30 2017	update 50000 variants	1277 : 8723
Wed May 24 19:57:30 2017	update 60000 variants	1575 : 8425
Wed May 24 19:57:31 2017	update 70000 variants	2745 : 7255
Wed May 24 19:57:31 2017	update 80000 variants	1670 : 8330
Wed May 24 19:57:32 2017	update 90000 variants	220 : 9780
match 93141 records
Wed May 24 19:57:41 2017	GO parsing start
Wed May 24 19:57:41 2017	Running GO_parse.pl start
Wed May 24 19:57:41 2017	Output header to ./VarSelectAnalysisResult_20170524172945/work_20170524172945/go_header_20170524172945.txt
Wed May 24 19:57:41 2017	Loading mapping of Ensembl transcript to database /peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref start
/peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref
Wed May 24 19:57:44 2017	Loading mapping of Ensembl transcript to database /peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref finish
Wed May 24 19:57:44 2017	Extracting transcript infomation from ./example1_20170524172945_varselect.db
Wed May 24 19:58:52 2017	Running GO_parse.pl finish
Wed May 24 19:58:52 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/vsl_annot.pl  -j 20170524172945  -f ./VarSelectAnalysisResult_20170524172945/VsResult_20170524172945_go.vcf.gz   -a extract  -e GO_Biological_Process,GO_Cellular_Component,GO_Molecular_Function  -t text,text,text  -c GO_Biological_Process,GO_Cellular_Component,GO_Molecular_Function  -d ./example1_20170524172945_varselect.db  -b varselect_variants  2> ./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr_vsl_GO_20170524172945.log
update varselect_variants SET 'GO_Biological_Process'=? , 'GO_Cellular_Component'=? , 'GO_Molecular_Function'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 93141
Wed May 24 19:59:59 2017	update 10000 variants	2166 : 7834
Wed May 24 20:00:00 2017	update 20000 variants	4886 : 5114
Wed May 24 20:00:01 2017	update 30000 variants	4497 : 5503
Wed May 24 20:00:02 2017	update 40000 variants	4570 : 5430
Wed May 24 20:00:03 2017	update 50000 variants	7503 : 2497
Wed May 24 20:00:04 2017	update 60000 variants	4217 : 5783
Wed May 24 20:00:05 2017	update 70000 variants	6586 : 3414
Wed May 24 20:00:06 2017	update 80000 variants	6692 : 3308
Wed May 24 20:00:06 2017	update 90000 variants	1520 : 8480
match 93141 records
Wed May 24 20:00:17 2017	GO parse finish
Wed May 24 20:00:17 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/create_view_for_varselect.pl -j 20170524172945 -d ./example1_20170524172945_varselect.db 2> ./VarSelectAnalysisResult_20170524172945/log_20170524172945/stderr_view_create_20170524172945.log
Wed May 24 20:00:18 2017	VSannot finish
