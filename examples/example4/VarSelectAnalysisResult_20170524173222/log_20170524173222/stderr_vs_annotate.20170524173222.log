Wed May 24 17:32:22 2017	VS annot start
Wed May 24 17:32:22 2017	Jobid: 20170524173222
Wed May 24 17:32:22 2017	-n 4 -p example4.ped -k 1 -d ./example4_20170524173222_varselect.db -v example4.txt -j 20170524173222
Wed May 24 17:32:22 2017	Load and check VCF file list start
Wed May 24 17:32:22 2017	Clean variants with multiple line or wrong sample format values: NA12878-gatk-chr22.vcf.gz
Wed May 24 17:33:01 2017	Clean variants with multiple line or wrong sample format values: NA12891-gatk-chr22.vcf.gz
Wed May 24 17:33:34 2017	Clean variants with multiple line or wrong sample format values: NA12892-gatk-chr22.vcf.gz
Wed May 24 17:34:12 2017	Clean variants with multiple line or wrong sample format values: NA12878-freebayes-chr22.vcf.gz
Wed May 24 17:35:00 2017	Clean variants with multiple line or wrong sample format values: NA12891-freebayes-chr22.vcf.gz
Wed May 24 17:35:51 2017	Clean variants with multiple line or wrong sample format values: NA12892-freebayes-chr22.vcf.gz
Wed May 24 17:36:37 2017	Load and check VCF file list finish
Wed May 24 17:36:37 2017	Load ped file start
Wed May 24 17:37:24 2017	Output sex infomation of Sample to ./VarSelectAnalysisResult_20170524173222/example4_20170524173222_varselect_sample_sex_mcaller.txt
Wed May 24 17:37:24 2017	Load ped file finish
Wed May 24 17:37:24 2017	Check and concat vcf files from same sample start.
Wed May 24 17:37:34 2017	Check and concat vcf files from same sample finish.
Wed May 24 17:37:34 2017	Merge vcf files from different samples start.
Wed May 24 17:53:09 2017	Merge vcf files from different samples finish.
Wed May 24 17:53:09 2017	Fixing ploidy of sex chromosome start
Wed May 24 17:53:33 2017	Fixing ploidy of sex chromosome finish

/peterhouse/lchen/csardas/varselect_dev/scripts/vsann2.pl -v ./VarSelectAnalysisResult_20170524173222/example4_20170524173222_varselect_cleanXY.vcf.gz -p ./VarSelectAnalysisResult_20170524173222/work_20170524173222/example4_mcaller.ped -j 20170524173222 -d ./example4_20170524173222_varselect.db -n 4 2>./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr_vsann2_20170524173222.log
Wed May 24 17:53:34 2017	Running VEP start
Wed May 24 17:53:34 2017	Running snpEff start
Wed May 24 17:53:34 2017	Running ANNOVAR start
Wed May 24 18:24:03 2017	Running VEP finish
Wed May 24 18:24:03 2017	Gemini load vcf to db start
Wed May 24 19:25:47 2017	Running ANNOVAR finish
Indexing /peterhouse/lchen/csardas/varselect_publish/examples/example4/VarSelectAnalysisResult_20170524173222/work_20170524173222/snpeff_tmp.vcf.gz with grabix.
Loading 97918 variants.
Breaking /peterhouse/lchen/csardas/varselect_publish/examples/example4/VarSelectAnalysisResult_20170524173222/work_20170524173222/snpeff_tmp.vcf.gz into 4 chunks.
Loading chunk 0.
Loading chunk 1.
Loading chunk 2.
Loading chunk 3.
Done loading 97918 variants in 4 chunks.
2017-05-24 19:39:58 merging 4 chunks.
2017-05-24 19:40:07 merging 2 chunks.
2017-05-24 19:40:21 merged to final database....
2017-05-24 19:40:21 moved.
storing version, header, etc.
storing gene-detailed
storing gene-summary
updating gene-table
building indices
Wed May 24 19:47:05 2017	Running snpEff finish
Indexing /peterhouse/lchen/csardas/varselect_publish/examples/example4/VarSelectAnalysisResult_20170524173222/VsResult_20170524173222_vep.vcf.gz with grabix.
Loading 97918 variants.
Breaking /peterhouse/lchen/csardas/varselect_publish/examples/example4/VarSelectAnalysisResult_20170524173222/VsResult_20170524173222_vep.vcf.gz into 4 chunks.
Loading chunk 0.
Loading chunk 1.
Loading chunk 2.
Loading chunk 3.
Done loading 97918 variants in 4 chunks.
2017-05-24 19:51:34 merging 4 chunks.
2017-05-24 19:51:48 merging 2 chunks.
2017-05-24 19:52:12 merged to final database....
2017-05-24 19:52:12 moved.
storing version, header, etc.
storing gene-detailed
storing gene-summary
updating gene-table
building indices
Wed May 24 19:59:29 2017	Gemini load vcf to db finish
Wed May 24 19:59:29 2017	Gemini pathways start
Wed May 24 20:06:51 2017	13530 variants with pathways annotation
Wed May 24 20:07:13 2017	Gemini pathways finish
update variants SET 'AF'=? , 'BaseQRankSum'=? , 'FS'=? , 'MQRankSum'=? , 'ReadPosRankSum'=? , 'SOR'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 97918
Wed May 24 20:09:53 2017	update 10000 variants	10000 : 0
Wed May 24 20:10:02 2017	update 20000 variants	10000 : 0
Wed May 24 20:10:07 2017	update 30000 variants	10000 : 0
Wed May 24 20:10:14 2017	update 40000 variants	10000 : 0
Wed May 24 20:10:24 2017	update 50000 variants	10000 : 0
Wed May 24 20:10:32 2017	update 60000 variants	10000 : 0
Wed May 24 20:10:41 2017	update 70000 variants	10000 : 0
Wed May 24 20:10:51 2017	update 80000 variants	10000 : 0
Wed May 24 20:10:58 2017	update 90000 variants	10000 : 0
match 97918 records
Wed May 24 20:11:20 2017	sqlite3 ./example4_20170524173222_varselect.db 'alter table variants rename to vep_variants' 2> ./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr.tbl_rename_vep_variants_20170524173222.log 
Wed May 24 20:11:20 2017	CREATE & INSERT TABLE varselect_info start
Wed May 24 20:11:20 2017	CREATE TABLE IF NOT EXISTS varselect_info (  sn INTEGER  , vcfgz_for_analysis BLOB  , sample_list TEXT  , caller_list TEXT  , multicaller BOOLEAN )
Wed May 24 20:11:24 2017	CREATE & INSERT TABLE varselect_info finish
Wed May 24 20:11:46 2017	Create table annovar_variants start
Wed May 24 20:11:50 2017	Create table annovar_variants finish
Wed May 24 20:11:50 2017	Extract info fields from ANNOVAR finish
update annovar_variants SET '1000G_AFR'=? , '1000G_ALL'=? , '1000G_AMR'=? , '1000G_EAS'=? , '1000G_EUR'=? , '1000G_SAS'=? , '1000g2015aug_all'=? , 'AA_alt'=? , 'AA_position'=? , 'AA_ref'=? , 'APOGEE'=? , 'APOGEE_probN'=? , 'APOGEE_probP'=? , 'Associated_disease'=? , 'CADD'=? , 'CADD_phred'=? , 'CADD_score'=? , 'CAROL'=? , 'CAROL_score'=? , 'CG46'=? , 'CHASM_FDR'=? , 'CHASM_pvalue'=? , 'CLINSIG'=? , 'CLNACC'=? , 'CLNDBN'=? , 'CLNDSDB'=? , 'CLNDSDBID'=? , 'COSMIC_frequency'=? , 'COSMIC_id'=? , 'COSMIC_samples'=? , 'COSMIC_tumor_site'=? , 'COVEC_WMV'=? , 'COVEC_WMV_score'=? , 'Codon_substitution'=? , 'Condel'=? , 'Condel_score'=? , 'EFIN_HD'=? , 'EFIN_HD_score'=? , 'EFIN_SP'=? , 'EFIN_SP_score'=? , 'ESP6500siv2_AA'=? , 'ESP6500siv2_ALL'=? , 'ESP6500siv2_EA'=? , 'Ensembl_gene_id'=? , 'Ensembl_protein_id'=? , 'Ensembl_transcript_id'=? , 'ExAC_AFR'=? , 'ExAC_ALL'=? , 'ExAC_AMR'=? , 'ExAC_EAS'=? , 'ExAC_FIN'=? , 'ExAC_NFE'=? , 'ExAC_OTH'=? , 'ExAC_SAS'=? , 'ExAC_nonpsych_AFR'=? , 'ExAC_nonpsych_ALL'=? , 'ExAC_nonpsych_AMR'=? , 'ExAC_nonpsych_EAS'=? , 'ExAC_nonpsych_FIN'=? , 'ExAC_nonpsych_NFE'=? , 'ExAC_nonpsych_OTH'=? , 'ExAC_nonpsych_SAS'=? , 'ExAC_nontcga_AFR'=? , 'ExAC_nontcga_ALL'=? , 'ExAC_nontcga_AMR'=? , 'ExAC_nontcga_EAS'=? , 'ExAC_nontcga_FIN'=? , 'ExAC_nontcga_NFE'=? , 'ExAC_nontcga_OTH'=? , 'ExAC_nontcga_SAS'=? , 'FATHMM_coding'=? , 'FATHMM_noncoding'=? , 'FatHmmW'=? , 'FatHmmW_score'=? , 'FatHmm_pred'=? , 'FatHmm_score'=? , 'GME_AF'=? , 'GME_AP'=? , 'GME_CA'=? , 'GME_Israel'=? , 'GME_NEA'=? , 'GME_NWA'=? , 'GME_SD'=? , 'GME_TP'=? , 'Gene_position'=? , 'Gene_symbol'=? , 'HRC_AC'=? , 'HRC_AF'=? , 'HRC_AN'=? , 'HRC_non1000G_AC'=? , 'HRC_non1000G_AF'=? , 'HRC_non1000G_AN'=? , 'ICGC_Id'=? , 'ICGC_Occurrence'=? , 'Kaviar_AC'=? , 'Kaviar_AF'=? , 'Kaviar_AN'=? , 'MISTIC_coevo_sites'=? , 'MISTIC_mean_MI_score'=? , 'Meta_SNP'=? , 'Meta_SNP_RI'=? , 'Meta_SNP_score'=? , 'MitImpact_id'=? , 'MutationAssessor'=? , 'MutationAssessor_score'=? , 'MutationAssessor_transf'=? , 'MutationAssessor_transf_score'=? , 'Ncbi_gene_id'=? , 'Ncbi_protein_id'=? , 'OXPHOS_complex'=? , 'PANTHER'=? , 'PANTHER_score'=? , 'PROVEAN'=? , 'PROVEAN_score'=? , 'PhD_SNP'=? , 'PhD_SNP_score'=? , 'PhastCons_100V'=? , 'PhyloP_100V'=? , 'PolyPhen2'=? , 'PolyPhen2_score'=? , 'PolyPhen2_transf'=? , 'PolyPhen2_transf_score'=? , 'PopFreqMax'=? , 'SIFT'=? , 'SIFT_score'=? , 'SIFT_transf'=? , 'SIFT_transf_score'=? , 'SNAP'=? , 'SNAP_score'=? , 'SiteVar'=? , 'Uniprot_id'=? , 'Uniprot_name'=? , 'VEST_FDR'=? , 'VEST_pvalue'=? , 'Variant_class'=? , 'Variant_status'=? , 'avsift'=? , 'avsnp147'=? , 'cg69'=? , 'cosmic70'=? , 'dbSNP_id'=? , 'dbscSNV_ADA_SCORE'=? , 'dbscSNV_RF_SCORE'=? , 'gerpxxgt2'=? , 'gwasCatalog'=? , 'nci60'=? , 'phastConsElements46way'=? , 'tfbsConsSites'=? , 'wgRna'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 97918
Wed May 24 20:17:02 2017	update 10000 variants	9877 : 123
Wed May 24 20:17:14 2017	update 20000 variants	9853 : 147
Wed May 24 20:17:26 2017	update 30000 variants	9905 : 95
Wed May 24 20:17:38 2017	update 40000 variants	9887 : 113
Wed May 24 20:17:52 2017	update 50000 variants	9865 : 135
Wed May 24 20:18:04 2017	update 60000 variants	9852 : 148
Wed May 24 20:18:13 2017	update 70000 variants	9865 : 135
Wed May 24 20:18:24 2017	update 80000 variants	9889 : 111
Wed May 24 20:18:35 2017	update 90000 variants	9909 : 91
match 97918 records
Wed May 24 20:19:20 2017	Extract info fields from ANNOVAR finish
Wed May 24 20:19:20 2017	Create table varselect_variants start
Wed May 24 20:19:20 2017	sqlite3 ./example4_20170524173222_varselect.db 'CREATE TABLE varselect_variants as select variant_id,chrom,start,"end",ref,alt from vep_variants '
Wed May 24 20:19:24 2017	sqlite3 ./example4_20170524173222_varselect.db 'CREATE INDEX vslvars_vid_idx ON varselect_variants(variant_id)'  2> ./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr_idx_create_vslvars_varselect_variants_20170524173222.log 
Wed May 24 20:19:25 2017	Create table varselect_variants finish
Wed May 24 20:19:25 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/vsl_annot.pl  -j 20170524173222  -f ./VarSelectAnalysisResult_20170524173222/VsResult_20170524173222_pathway.vcf.gz  -a extract  -e pathway  -t text  -c pathway  -d ./example4_20170524173222_varselect.db  -b varselect_variants  2> ./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr_vsl_pathway_20170524173222.log 
update varselect_variants SET 'pathway'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 97918
Wed May 24 20:20:57 2017	update 10000 variants	256 : 9744
Wed May 24 20:20:58 2017	update 20000 variants	2545 : 7455
Wed May 24 20:20:58 2017	update 30000 variants	1235 : 8765
Wed May 24 20:20:59 2017	update 40000 variants	821 : 9179
Wed May 24 20:20:59 2017	update 50000 variants	1575 : 8425
Wed May 24 20:21:00 2017	update 60000 variants	927 : 9073
Wed May 24 20:21:00 2017	update 70000 variants	2853 : 7147
Wed May 24 20:21:01 2017	update 80000 variants	1805 : 8195
Wed May 24 20:21:01 2017	update 90000 variants	881 : 9119
match 97918 records
Wed May 24 20:21:18 2017	GO parsing start
Wed May 24 20:21:18 2017	Running GO_parse.pl start
Wed May 24 20:21:18 2017	Output header to ./VarSelectAnalysisResult_20170524173222/work_20170524173222/go_header_20170524173222.txt
Wed May 24 20:21:18 2017	Loading mapping of Ensembl transcript to database /peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref start
/peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref
Wed May 24 20:21:21 2017	Loading mapping of Ensembl transcript to database /peterhouse/lchen/csardas/varselect_dev/db/ENST2GO.hashref finish
Wed May 24 20:21:21 2017	Extracting transcript infomation from ./example4_20170524173222_varselect.db
Wed May 24 20:22:58 2017	Running GO_parse.pl finish
Wed May 24 20:22:58 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/vsl_annot.pl  -j 20170524173222  -f ./VarSelectAnalysisResult_20170524173222/VsResult_20170524173222_go.vcf.gz   -a extract  -e GO_Biological_Process,GO_Cellular_Component,GO_Molecular_Function  -t text,text,text  -c GO_Biological_Process,GO_Cellular_Component,GO_Molecular_Function  -d ./example4_20170524173222_varselect.db  -b varselect_variants  2> ./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr_vsl_GO_20170524173222.log
update varselect_variants SET 'GO_Biological_Process'=? , 'GO_Cellular_Component'=? , 'GO_Molecular_Function'=? where variant_id = ? 
chr22, 16050251, A, T, 1
chr22, 51243068, A, AT, 97918
Wed May 24 20:24:37 2017	update 10000 variants	1769 : 8231
Wed May 24 20:24:39 2017	update 20000 variants	5287 : 4713
Wed May 24 20:24:40 2017	update 30000 variants	3952 : 6048
Wed May 24 20:24:40 2017	update 40000 variants	4055 : 5945
Wed May 24 20:24:42 2017	update 50000 variants	7469 : 2531
Wed May 24 20:24:43 2017	update 60000 variants	4328 : 5672
Wed May 24 20:24:44 2017	update 70000 variants	6894 : 3106
Wed May 24 20:24:45 2017	update 80000 variants	6826 : 3174
Wed May 24 20:24:46 2017	update 90000 variants	3742 : 6258
match 97918 records
Wed May 24 20:25:00 2017	GO parse finish
Wed May 24 20:25:00 2017	/peterhouse/lchen/csardas/varselect_dev/scripts/create_view_for_varselect.pl -j 20170524173222 -d ./example4_20170524173222_varselect.db 2> ./VarSelectAnalysisResult_20170524173222/log_20170524173222/stderr_view_create_20170524173222.log
Wed May 24 20:25:00 2017	VSannot finish
